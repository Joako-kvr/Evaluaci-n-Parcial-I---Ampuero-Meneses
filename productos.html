<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Productos — Pastelería Mil Sabores</title>
  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/styles/style.css">
</head>

<!-- Modal de Detalle + Reseña (mockup) -->
<div class="modal fade" id="modalDetalle" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title" id="detNombre">Detalle de producto</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>

      <div class="modal-body">
        <div class="row g-4">
          <div class="col-lg-6">
            <div class="ratio ratio-4x3 rounded-3 overflow-hidden shadow-sm bg-white">
              <img id="detImg" alt="" class="w-100 h-100 object-fit-contain p-2"
                   onerror="this.onerror=null;this.src='assets/images/pastel_fresa.png';">
            </div>
          </div>
          <div class="col-lg-6">
            <p class="text-muted mb-1" id="detCat">Categoría</p>
            <p class="fs-4 fw-bold mb-2" id="detPrecio">$ 0</p>
            <p id="detDesc" class="mb-3">Descripción…</p>
            <small class="text-muted">* Demo: sin pago ni pedido.</small>
          </div>
        </div>

        <hr class="my-4">

        <!-- Reseña (mockup, no guarda) -->
        <h6 class="mb-2">Deja tu reseña (mockup)</h6>
        <div class="row g-2">
          <div class="col-sm-4">
            <label class="form-label">Puntaje</label>
            <select class="form-select" id="detPuntaje">
              <option value="5">5 ★★★★★</option>
              <option value="4">4 ★★★★☆</option>
              <option value="3">3 ★★★☆☆</option>
              <option value="2">2 ★★☆☆☆</option>
              <option value="1">1 ★☆☆☆☆</option>
            </select>
          </div>
          <div class="col-12">
            <label class="form-label">Tu reseña</label>
            <textarea class="form-control" id="detResena" rows="3"
                      placeholder="Escribe tu comentario…"></textarea>
          </div>
          <div class="col-12 mt-2">
            <button type="button" class="btn btn-primary"
                    onclick="alert('Reseña enviada (mockup). No se guarda.');">
              Enviar
            </button>
            <small class="ms-2 text-muted">* Sin funcionalidad real, solo visual.</small>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<body>

  <!-- NAV sencilla para tu estructura de archivos -->
  <nav class="navbar navbar-expand-lg bg-body-tertiary">
    <div class="container">
      <a class="navbar-brand fw-bold" href="home.html">Pastelería Mil Sabores</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div id="nav" class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="home.html">Inicio</a></li>
        <li class="nav-item"><a class="nav-link active" href="productos.html">Productos</a></li>
        <li class="nav-item"><a class="nav-link" href="registro.html">Registro</a></li>
        <li class="nav-item"><a class="nav-link" href="iniciar sesion.html">Iniciar Sesion</a></li>
        <li class="nav-item"><a class="nav-link " href="nosotros.html">Nosotros</a></li>
        <li class="nav-item"><a class="nav-link " href="blog.html">Blog</a></li>
        <li class="nav-item"><a class="nav-link " href="contacto.html">Contacto</a></li>
        <li class="nav-item"><a class="nav-link" href="productos.html">Carrito</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <main class="container my-4">
    <div class="row g-4">
      <!-- LISTA DE PRODUCTOS -->
      <section class="col-lg-8">
        <h1 class="h3 mb-3">Productos</h1>

        <!-- Filtros -->
        <div class="row g-3 mb-3">
          <div class="col-md-6">
            <label class="form-label">Categoría</label>
            <select id="filtroCategoria" class="form-select"></select>
          </div>
          <div class="col-md-6">
            <label class="form-label">Buscar</label>
            <input id="filtroTexto" class="form-control" placeholder="Nombre o descripción">
          </div>
        </div>

        <div id="listaProductos" class="row g-3"></div>
      </section>

      <!-- CARRITO -->
      <aside class="col-lg-4">
        <h2 class="h4 mb-3">Carrito</h2>
        <ol id="carrito" class="list-group list-group-numbered"></ol>
        <div class="d-flex justify-content-between align-items-center mt-3">
          <strong id="totalCarrito">Total: $ 0</strong>
          <button id="btnVaciar" class="btn btn-outline-secondary btn-sm">Vaciar</button>
        </div>
      </aside>
    </div>
  </main>
  <footer class="mt-5 py-4 text-center text-muted bg-light">
  <div class="container small">
     <p>&copy;2025 Pastelería Mil Sabores. Todos los derechos reservados.</p>
  </div>
</footer>

  <!-- ======= SCRIPTS ======= -->
  <script>
    /* ========= Catálogo ========= */
    const CATEGORIAS = [
      "Tortas Cuadradas","Tortas Circulares","Postres Individuales","Productos Sin Azúcar",
      "Pastelería Tradicional","Productos Sin Gluten","Productos Vegana","Tortas Especiales"
    ];
    

    const PRODUCTS = [
      // Tortas Cuadradas
    {codigo: "TC001",categoria: "Tortas Cuadradas",nombre: "Torta Cuadrada de Chocolate",precio: 45000,img: "assets/images/torta_cuadrada_de_chocolate.png",desc: "Ganache de chocolate con avellanas."},
      {codigo:"TC002", categoria:"Tortas Cuadradas", nombre:"Torta Cuadrada de Frutas", precio:50000, img:"assets/images/torta_cuadrada_de_frutas.png", desc:"Frutas frescas y crema chantilly."},

      // Tortas Circulares
      {codigo:"TT001", categoria:"Tortas Circulares", nombre:"Torta Circular de Vainilla", precio:40000, img:"assets/images/torta_circular_de_vainilla.png", desc:"Bizcocho de vainilla con crema pastelera."},
      {codigo:"TT002", categoria:"Tortas Circulares", nombre:"Torta Circular de Manjar", precio:42000, img:"assets/images/torta_circular_de_manjar.png", desc:"Manjar y nueces, tradición chilena."},

      // Postres Individuales
      {codigo:"PI001", categoria:"Postres Individuales", nombre:"Mousse de Chocolate", precio:5000, img:"assets/images/mousse_de_chocolate.png", desc:"Cremoso y suave."},
      {codigo:"PI002", categoria:"Postres Individuales", nombre:"Tiramisú Clásico", precio:5500, img:"assets/images/tiramisu_clasico.png", desc:"Café, mascarpone y cacao."},

      // Productos Sin Azúcar
      {codigo:"PSA001", categoria:"Productos Sin Azúcar", nombre:"Torta Sin Azúcar de Naranja", precio:48000, img:"assets/images/torta_sin_azucar_de_naranja.png", desc:"Sabor cítrico sin azúcar añadida."},
      {codigo:"PSA002", categoria:"Productos Sin Azúcar", nombre:"Cheesecake Sin Azúcar", precio:47000, img:"assets/images/Cheesecake_sin_azucar.png", desc:"Suave y equilibrado."},

      // Pastelería Tradicional
      {codigo:"PT001", categoria:"Pastelería Tradicional", nombre:"Empanada de Manzana", precio:3000, img:"assets/images/empanada_de_manzana.png", desc:"Clásico dulce horneado."},
      {codigo:"PT002", categoria:"Pastelería Tradicional", nombre:"Tarta de Santiago", precio:6000, img:"assets/images/tarta_de_santiago.png", desc:"Tradición con almendras."},

      // Productos Sin Gluten
      {codigo:"PG001", categoria:"Productos Sin Gluten", nombre:"Brownie Sin Gluten", precio:3500, img:"assets/images/brownie_sin_gluten.png", desc:"Denso y chocolatoso."},
      {codigo:"PG002", categoria:"Productos Sin Gluten", nombre:"Pan Sin Gluten", precio:4000, img:"assets/images/pan_sin_gluten.png", desc:"Suave y esponjoso."},

      // Productos Vegana
      {codigo:"PV001", categoria:"Productos Vegana", nombre:"Torta Vegana de Chocolate", precio:50000, img:"assets/images/torta_vegana_de_chocolate.png", desc:"Sin productos de origen animal."},
      {codigo:"PV002", categoria:"Productos Vegana", nombre:"Galletas Veganas de Avena", precio:4500, img:"assets/images/galletas_veganas_de_avena.png", desc:"Crujientes y sabrosas."},

      // Tortas Especiales
      {codigo:"TE001", categoria:"Tortas Especiales", nombre:"Torta Especial de Cumpleaños", precio:55000, img:"assets/images/torta_especial_de_cumpleaños.png", desc:"Personalizable."},
      {codigo:"TE002", categoria:"Tortas Especiales", nombre:"Torta Especial de Boda", precio:60000, img:"assets/images/torta_especial_de_boda1.png", desc:"Elegante y deliciosa."}
    ];

    /* ========= Render de productos ========= */
function cardProducto(p){
  return `
  <div class="col-md-6 col-lg-4">
    <div class="card h-100">
      <div class="ratio ratio-4x3">
        <img src="${p.img}" class="w-100 h-100 object-fit-cover" alt="${p.nombre}">
      </div>
      <div class="card-body d-flex flex-column">
        <h5 class="card-title">${p.nombre}</h5>
        <p class="text-muted small mb-1">${p.categoria}</p>
        <p class="small text-secondary clamp-2 mb-2">${p.desc || ""}</p>
        <p class="mb-3 fw-semibold">$ ${p.precio.toLocaleString('es-CL')}</p>

        <div class="mt-auto d-flex gap-2">
          <a class="btn btn-outline-primary"
             data-bs-toggle="modal" data-bs-target="#modalDetalle"
             onclick="cargarDetalle('${p.codigo}')">Ver detalle</a>

          <a href="#" class="btn btn-primary"
             onclick="agregarProducto('${p.codigo}','${p.nombre.replace(/'/g, '\\\'')}', ${p.precio}); return false;">
             Agregar
          </a>
        </div>
      </div>
    </div>
  </div>`;
}


    function poblarCategorias(){
      const sel = document.getElementById('filtroCategoria');
      sel.innerHTML = `<option value="">Todas</option>` + CATEGORIAS.map(c => `<option>${c}</option>`).join('');
    }

    function renderLista(){
      const cat = document.getElementById('filtroCategoria').value;
      const txt = document.getElementById('filtroTexto').value.toLowerCase().trim();
      let lista = PRODUCTS.slice();
      if(cat) lista = lista.filter(p => p.categoria === cat);
      if(txt) lista = lista.filter(p => (p.nombre + ' ' + p.desc).toLowerCase().includes(txt));
      document.getElementById('listaProductos').innerHTML = lista.map(cardProducto).join('');
    }

      /* ========= Carrito ========= */
    let sumaTotal = 0;
    function agregarProducto(codigo, nombre, precio){
      
      const liId = 'producto-carrito-' + codigo + '-' + cryptoRandom();
      document.getElementById('carrito').innerHTML += `
        <li class="list-group-item d-flex justify-content-between align-items-start" id="${liId}">
          <div class="ms-2 me-auto">
            <div class="fw-bold">${nombre}</div>
            <a href="#" onclick="removerProducto('${liId}', ${precio}); return false;">Quitar</a>
          </div>
          <span class="badge text-bg-primary rounded-pill">$ ${precio.toLocaleString('es-CL')}</span>
        </li>`;
      sumaTotal += precio;
      actualizarTotal();
    }

    function removerProducto(liId, precio){
      const el = document.getElementById(liId);
      if(el) el.remove();
      sumaTotal -= precio;
      if(sumaTotal < 0) sumaTotal = 0;
      actualizarTotal();
    }

    function vaciarCarrito(){
      document.getElementById('carrito').innerHTML = '';
      sumaTotal = 0;
      actualizarTotal();
    }

    function actualizarTotal(){
      document.getElementById('totalCarrito').textContent = "Total: $ " + sumaTotal.toLocaleString('es-CL');
    }

    // ID simple para items (evita conflictos si agregas el mismo producto muchas veces)
    function cryptoRandom(){
      try { return crypto.getRandomValues(new Uint32Array(1))[0].toString(16); }
      catch { return Math.floor(Math.random()*1e9).toString(16); }
    }
    
  function cargarDetalle(codigo){
    const p = PRODUCTS.find(x => x.codigo === codigo);
    if(!p) return;
    document.getElementById('detNombre').textContent = p.nombre;
    document.getElementById('detCat').textContent    = p.categoria;
    document.getElementById('detPrecio').textContent = '$ ' + p.precio.toLocaleString('es-CL');
    document.getElementById('detDesc').textContent   = p.desc || '';
    document.getElementById('detImg').src            = p.img;
    // Limpia campos de reseña (mock)
    document.getElementById('detResena').value = '';
    document.getElementById('detPuntaje').value = '5';
  }







    /* ========= Inicialización ========= */
    document.addEventListener('DOMContentLoaded', () => {
      poblarCategorias();
      renderLista();
      document.getElementById('filtroCategoria').addEventListener('change', renderLista);
      document.getElementById('filtroTexto').addEventListener('input', renderLista);
      document.getElementById('btnVaciar').addEventListener('click', vaciarCarrito);
    });

    

  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
          crossorigin="anonymous"></script>
</body>
</html>
